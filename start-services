#!/bin/sh

CMD="qdb/bin/qdbd"
ARGS="-a 127.0.0.1:28360 --max-open-files=63440 --log-level=debug --security=false --transient -r qdb/db"
SECURE_ARGS="-a 127.0.0.1:28361 --max-open-files=63440 --log-level=debug --security=true --cluster-private-file=cluster-secret-key.txt --user-list=users.txt --transient -r qdb/securedb"

echo "Cleaning up..."
pkill -SIGKILL -f qdbd
rm -rf qdb/db \
    && rm -rf qdb/securedb \
    && mkdir -p qdb/db \
    && mkdir -p qdb/securedb

echo "Starting qdbd..."
$CMD $ARGS 1>qdbd.out.txt 2>qdbd.err.txt &

echo "Starting qdbd (secure)..."

$CMD $SECURE_ARGS 1>qdbd.secure.out.txt 2>qdbd.secure.err.txt &
